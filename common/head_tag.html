<!-- SYSTEM JAVASCRIPT - DO NOT EDIT -->
<script type="text/javascript" nonce="{{nonce}}">
    //Remove form spinner after form is loaded
    function removeFormSpinner() {
		let spinner = document.querySelector('form.marketo-form .spinner-wrapper');
		if(spinner){ 
			document.querySelector('form.marketo-form').removeChild(spinner);
		}
	}	    
	    
    var profiling = {
      isEnabled: false,
      numberOfProfilingFields: 3,
      alwaysShowFields: [ 'mktDummyEntry']
    };

    var mktFormLanguage = 'English'
</script>
    
<!-- Created Theme component to add Download form in Discourse [By Webdirekt on 02-11-2020] -->
<script type="text/discourse-plugin" version="0.8">
    const { h } = require('virtual-dom');
    const DiscourseURL = require('discourse/lib/url').default;    
        
	
    /* Below code will render "download_form" widget before rendering "post-menu" widget on Topic page*/


const forms2MinJsUrl = "https://info.softwareag.com/js/forms2/js/forms2.min.js";
const munchkinJsUrl = "https://munchkin.marketo.net/munchkin.js";
const mktFormSupportJsUrl = "https://info.softwareag.com/js/mktFormSupport.js";

function checkNull(value) {
  if (typeof (value) != "undefined" && value != null && value != 'null') {
    return value;
  }
  return "";
}

export default class DownloadForm extends Component {
  static getMarketoFormId(slug) {
    switch (slug) {
      case "adabas-and-natural-community-edition-download-form":
        return "mktoForm_12282";
    }
  }

  static shouldRender(args, context, owner) {
    if (!args.post.firstPost) {
      return false;
    }

    const currentTopic = owner.lookup("service:header").topicInfo
    return currentTopic && DownloadForm.getMarketoFormId(currentTopic.slug)
  }

  @service currentUser;
  @service header;
  @tracked forms2MinJs;

  get marketoFormId() {
    return DownloadForm.getMarketoFormId(this.header.topicInfo.slug);
  }

  @bind
  loadJS() {
    let forms2MinJs = document.querySelector(`head script[src="${forms2MinJsUrl}"]`);

    if (!forms2MinJs) {
      forms2MinJs = document.createElement("script");
      let munchkinJs = document.createElement("script");
      let mktFormSupportJs = document.createElement("script");

      forms2MinJs.src = forms2MinJsUrl;
      forms2MinJs.setAttribute("nonce", "");
      document.head.appendChild(forms2MinJs);

      munchkinJs.src = munchkinJsUrl;
      munchkinJs.setAttribute("nonce", "");
      document.head.appendChild(munchkinJs);

      mktFormSupportJs.src = mktFormSupportJsUrl;
      mktFormSupportJs.setAttribute("nonce", "");
      document.head.appendChild(mktFormSupportJs);
    }

    this.forms2MinJs = forms2MinJs;
  }

  <template>
    <div class="d-form"
      {{didInsert this.loadJS}}
    >

    </div>
  </template>
}

	
</script>
